function appHost(){if(window.chrome&&window.chrome.webview&&window.chrome.webview.hostObjects&&window.chrome.webview.hostObjects.powermapper)return window.chrome.webview.hostObjects.sync.powermapper;if(window.external)return window.external;if(window.webkit&&window.webkit.messageHandlers){var e=new Object;return new Proxy(e,{get:function(e,t){return function(){if(null!=t){var e=generateUniqueID(),n="window.webkit.messageHandlers."+t+".postMessage({'promiseID':'"+e+"', 'params':[";if(null!=arguments&&arguments.length>0)for(var a=0;a<arguments.length;a++)argument=arguments[a],n+="string"==typeof argument||"object"==typeof argument?"'"+argument+"'":argument,a<arguments.length-1&&(n+=", ");return n+="]});",generatePromise(n,e)}}}})}return null}function generatePromise(e,t){var n=new Promise(function(n,a){this.promises[t]={resolve:n,reject:a};try{new Function(e)()}catch(l){}});return n}function resolvePromise(e,t,n){n?promises[e].reject(t):promises[e].resolve(t),delete promises[e]}function generateUniqueID(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t}function addListener(e,t,n){var a,l;if(document.querySelectorAll)for(a=document.querySelectorAll(e),l=0;l<a.length;l++)document.addEventListener?a[l].addEventListener(t,n,!1):a[l].attachEvent("on"+t,n);else{var s=e.split("."),o=s[0],i=s[1];if(2==s.length)for(a=document.getElementsByTagName(o),l=0;l<a.length;l++)-1!=a[l].className.indexOf(i)&&a[l].attachEvent("on"+t,n)}}function pageLoad(){if(expandRules(),enableRules(),enableSpellings(),addListener(".viewsource[data-pageid]","click",function(e){var t=this!=window?this:e.srcElement;try{const n=parseInt(t.getAttribute("data-pageid")),a=parseInt(t.getAttribute("data-line")),l=parseInt(t.getAttribute("data-col"));appHost().ViewSource(n,a,l);e.preventDefault()}catch(s){}}),addListener("button.toggleChevron","click",function(e){var t=this!=window?this:e.srcElement;toggleChevron(t.getAttribute("data-toggleid"))}),addListener("td.desc","click",function(e){if(window.getSelection().toString());else{var t=this!=window?this:e.srcElement;toggleChevron(t.getAttribute("data-toggleid"))}}),addListener("button.expandAll","click",function(){expandAll()}),addListener("td.expandAll","click",function(){window.getSelection().toString()||expandAll()}),addListener("a.spell-bad","click",function(e){var t=this!=window?this:e.srcElement;spellOptions(t,t.getAttribute("data-platform")),e.preventDefault()}),addListener("a.spell-good","click",function(e){var t=this!=window?this:e.srcElement;spellOptions(t,t.getAttribute("data-platform")),e.preventDefault()}),addListener("button.ruleOptions","click",function(e){var t=this!=window?this:e.srcElement;ruleOptions(t,t.getAttribute("data-ruleid"))}),addListener("button.pageOptions","click",function(e){var t=this!=window?this:e.srcElement;pageOptions(t,t.getAttribute("data-url"))}),!document.addEventListener)for(var e=document.getElementsByTagName("img"),t=/.*\.svg$/,n=e.length,a=0;n>a;a++)e[a].src.match(t)&&(e[a].src=e[a].src.slice(0,-3)+"png")}function expandRules(){0==window.location.hash.indexOf("#page-")&&addExpandedRule("expando-"+window.location.hash.substring(1));var e=document.getElementById("expandedRuleList");if(e){var t=e.value.split("#");if(""!=t[0])for(var n=0;n<t.length;n++)toggleChevron(t[n])}}function removeExpandedRule(e){var t=document.getElementById("expandedRuleList");if(t){var n=t.value.split("#");if(t.value="",""!=n[0])for(var a=0;a<n.length;a++)n[a]!=e&&addExpandedRule(n[a])}}function expandAll(){var e,t=-1!=document.getElementById("chevExpandAll").getAttribute("src").indexOf("chevron-down");if(document.querySelectorAll){var n=document.querySelectorAll("tbody.expando");for(e=0;e<n.length;e++)t?n[e].style.display="table-row-group":n[e].style.display="none"}var a=document.getElementsByTagName("img");for(e=0;e<a.length;++e){var l=a[e].id;0==l.indexOf("chev")&&(t?a[e].src=a[e].src.replace(/chevron-down/i,"chevron-up"):a[e].src=a[e].src.replace(/chevron-up/i,"chevron-down"))}}function addExpandedRule(e){var t=document.getElementById("expandedRuleList");if(t){var n=t.value.split("#");if(""==n[0])t.value=e;else{for(var a=!1,l=0;l<n.length;l++)if(n[l]==e){a=!0;break}a||(t.value=t.value+"#"+e)}}}function showTab(e,t){document.getElementById("menu-summary").className="",document.getElementById("menu-issues").className="",document.getElementById("menu-all").className="",document.getElementById("menu-"+e).className="selected",document.getElementById("tab-summary").style.display="none",document.getElementById("tab-all").style.display="none",document.getElementById("tab-issues").style.display="none",document.getElementById("tab-"+e).style.display="inline",document.getElementById("tab-errors").style.display="none",document.getElementById("tab-compliance").style.display="none",document.getElementById("tab-standards").style.display="none",document.getElementById("tab-accessibility").style.display="none",document.getElementById("tab-usability").style.display="none",document.getElementById("tab-seo").style.display="none",document.getElementById("tab-compatibility").style.display="none",document.getElementById("tab-security").style.display="none",t&&(document.getElementById("menu-errors").className="",document.getElementById("menu-compliance").className="",document.getElementById("menu-standards").className="",document.getElementById("menu-accessibility").className="",document.getElementById("menu-usability").className="",document.getElementById("menu-seo").className="",document.getElementById("menu-compatibility").className="",document.getElementById("menu-security").className="",document.getElementById("tab-"+t).style.display="inline",document.getElementById("menu-"+t).className="selected")}function toggleChevron(e){var t=document.getElementById("chev"+e);-1!=t.src.indexOf("chevron-up")?(t.src=t.src.replace(/chevron-up/,"chevron-down"),removeExpandedRule(e)):(t.src=t.src.replace(/chevron-down/,"chevron-up"),addExpandedRule(e)),toggleElement("expand-"+e)}function enableRules(){for(var e=document.getElementsByTagName("tr"),t=0;t<e.length;++t){var n=e[t];if(n.id&&0==n.id.indexOf("rule-"))try{var a=n.id.substr(5),l=appHost().GetRuleEnabled(a);l?n.className="":n.className="disabled"}catch(s){}}}function enableSpellings(){for(var e=document.getElementsByTagName("a"),t=0;t<e.length;++t){var n=e[t];if("spell-bad"==n.className)try{if(n.innerText){var a=n.innerText,l=appHost().GetSpellingCorrect(a);l&&(n.className="spell-good")}}catch(s){}}}function spellOptions(e,t){var n={spellOther:0,spellAdded:1,spellRemoved:2};try{var a,l,s=n.spellOther,o=e.innerHTML;if("web"==t){var i="/Scans/AddCustomSpelling?word="+o,r="/Scans/RemoveCustomSpelling?word="+o,d=document.getElementById("iframeSpelling");-1!=d.src.indexOf(i)?(s=n.spellRemoved,d.src=r):(s=n.spellAdded,d.src=i)}else s=appHost().SpellOptions(e,o);if(s==n.spellAdded)for(e.className="spell-good",a=0;a<document.links.length;a++)l=document.links[a],"spell-bad"==l.className&&l.innerHTML==o&&(l.className="spell-good");else if(s==n.spellRemoved)for(e.className="spell-bad",a=0;a<document.links.length;a++)l=document.links[a],"spell-good"==l.className&&l.innerHTML==o&&(l.className="spell-bad")}catch(c){}}function ruleOptions(e,t){try{var n=appHost().RuleOptions(e,t),a=document.getElementById("rule-"+t);a&&(n?a.className="":a.className="disabled"),toggleElement("rule-"+t+"-disabled")}catch(l){alert("Options are only available when the report is viewed in SortSite.")}}function pageOptions(e,t){try{appHost().PageOptions(e,t)}catch(n){alert("Options are only available when the report is viewed in SortSite.")}}function toggleElement(e){var t=document.getElementById(e),n="";if(null!=t){for(var a=document.getElementsByTagName(t.tagName),l=0;l<a.length;++l){var s=getElementStyle(a[l]);if("none"!=s.display){n=s.display;break}}"none"==getElementStyle(t).display?t.style.display=n:t.style.display="none"}}function getElementStyle(e){return window.getComputedStyle?getComputedStyle(e):e.currentStyle}var categoryArraySize=9,categories=new Array(categoryArraySize);categories[0]="overallQuality",categories[1]="errors",categories[2]="compliance",categories[3]="standards",categories[4]="accessibility",categories[5]="usability",categories[6]="seo",categories[7]="security",categories[8]="compatibility",document.addEventListener?document.addEventListener("DOMContentLoaded",pageLoad):window.attachEvent("onload",pageLoad);var promises={};